var dataCheckElevator;var notRightElevator;let dataMainElevator;(function(){var o=new Date;var l="?"+o.getTime();var u;if(isOffline()||!isEtMall())return buildLocalElevator();makeLocalScript("data-check-elevator.js",l);var i=setInterval(function(){if(typeof dataCheckElevator!=="undefined"){clearInterval(i);const e=dataCheckElevator.startDate;const t=dataCheckElevator.endDate;const n=dataCheckElevator.onlineElevatorUrl.split("index.html")[0];const r=dataCheckElevator.mode;u=isDateOnline(e,o,t);const a=n+"data-main-elevator.json"+"?"+l;fetch(a).then(e=>{if(!e.ok){console.error("fetch時http錯誤："+e.status)}return e.json()}).then(e=>{dataMainElevator=e;return c(e,r,n,l)}).catch(e=>console.error(e))}},100);function c(e,t,n,r){const a="localElevatorLeft";const o="localElevatorRight";const l=isLocalCss(a);const i=isLocalCss(o);let c=false;checkElevatorWrap();if(u){if(isPageInList(e)||isModePass(t)){c=true}}if(c){var s="main-elevator-left.css";var f="main-elevator.js";notRightElevator=!i;makeOnlineFile(n,s,makeCssLink,r);if(l)removeElement(a);makeOnlineFile(n,f,makeAsyncScript,r)}else buildLocalElevator()}})();function isOffline(){if(location.protocol==="file:")return true;else return false}function buildLocalElevator(){const e=new Date;const t="?"+e.getTime();const n="localElevatorLeft";const r="localElevatorRight";const a=isLocalCss(n);const o=isLocalCss(r);if(a||o)makeLocalScript("sp-elevator.js",t)}function isDateOnline(e,t,n){var e=new Date(e);var n=new Date(n);if(!e||t<e)return false;if(t>=e){if(t>=n)return false;else return true}else return false}function isLocalCss(e){var t=document.getElementById(e);if(t)return true;else return false}function checkElevatorWrap(){var e=document.getElementById("elevatorHome");var t=document.getElementById("navRightBar");if(!e&&!t){console.error("HTML沒有電梯的家！");return false}}function makeCssLink(e,t,n){var r=document.createElement("link");var e=t?e+t:e;var a=document.getElementById(n);r.rel="stylesheet";r.href=e;if(a)a.parentNode.insertBefore(r,a.nextSibling);else document.head.appendChild(r)}function makeAsyncScript(e,t,n){var r=document.createElement("script");var e=t?e+t:e;var a=document.getElementById(n);r.src=e;r.async=true;if(a)document.body.insertBefore(r,a.nextSibling);else document.body.appendChild(r)}function makeLocalScript(e,t,n){var r=document.getElementById("checkElevator").src.split("check-elevator.js")[0];var a=r+e;var n=n;makeAsyncScript(a,t,n)}function isModePass(n="white",e="webLink"){var r=e;var t=dataCheckElevator.dataUrlList||[];var a;if(n==="white"){a=false}else if(n==="black"){a=true}t.forEach(function(e){var t;if(typeof e=="string"){t=e}else if(typeof e=="object"&&e!==null){t=e[r]}if(n==="white"){if(isUrlInList(t))a=true}else if(n==="black"){if(isUrlInList(t))a=false}});return a}function makeOnlineFile(e,t,n,r,a){if(!e){console.error("沒有共用電梯網址");return false}var o=e.split("index.html")[0];var l=o+t;if(typeof n==="function"){var a=a;n(l,r,a)}}function removeElement(e){var t=document.getElementById(e);t.parentNode.removeChild(t)}function isEtMall(){var e=decodeURIComponent(location.href);if(e.indexOf("etmall")!==-1)return true;else return false}function getFetchData(e,t){fetch(e).then(e=>{if(!e.ok){console.error("fetch時http錯誤："+e.status)}return e.json()}).then(e=>{if(typeof t==="function")t(e);else console.error("fetch後的callback非函數 或 沒指定callback函數")}).catch(e=>{console.error("本機端fetch失敗："+e)})}function isPageInList(e){if(!typeof linkItem=="object"&&linkItem!==null)throw new Error("fetch的JSON格式有誤");const t=[];objectItemsPushArray(e.sub,"webLink",t);objectItemsPushArray(e.depart,"webLink",t);return t.some(e=>{return isUrlInList(e)})}function getDeepKeys(n){return Object.keys(n).filter(e=>n[e]instanceof Object).map(t=>getDeepKeys(n[t]).map(e=>`${t}.${e}`)).reduce((e,t)=>e.concat(t),Object.keys(n))}function objectItemsPushArray(e,t,n){e.forEach(e=>{if(e[t]!==undefined)n.push(e[t])})}function isUrlInList(e){var t=e.split("index.html")[0];var n=decodeURIComponent(location.href);if(n.indexOf(t)!==-1)return true;else return false}